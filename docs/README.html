<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>行列解法・ICCG法関連文献</title>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fafafa;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            border-bottom: 1px solid #bdc3c7;
            padding-bottom: 5px;
            margin-top: 40px;
        }
        h3 {
            color: #555;
            margin-top: 30px;
        }
        h4 {
            color: #666;
            margin-top: 20px;
        }
        code {
            background-color: #ecf0f1;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
        }
        pre {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        pre code {
            background-color: transparent;
            padding: 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #bdc3c7;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #ecf0f1;
        }
        blockquote {
            border-left: 4px solid #3498db;
            margin: 20px 0;
            padding: 10px 20px;
            background-color: #ecf0f1;
        }
        .highlight {
            background-color: #fffacd;
            padding: 2px 5px;
            border-radius: 3px;
        }
        ul, ol {
            padding-left: 30px;
        }
        li {
            margin: 8px 0;
        }
        a {
            color: #3498db;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        hr {
            border: none;
            border-top: 1px solid #ddd;
            margin: 30px 0;
        }
        /* Reference link styling */
        .ref-link {
            color: #e74c3c;
            font-weight: bold;
            text-decoration: none;
        }
        .ref-link:hover {
            text-decoration: underline;
        }
        /* References section styling */
        ol.references {
            background-color: #f5f5f5;
            padding: 20px 20px 20px 45px;
            border-radius: 8px;
        }
        ol.references li {
            padding: 10px;
            background-color: #fff;
            border-radius: 5px;
            border-left: 3px solid #3498db;
            margin: 10px 0;
        }
        ol.references li:target {
            background-color: #fffacd;
            border-left-color: #e74c3c;
        }
        /* Math block styling (for display math) */
        .MathJax_Display {
            background-color: #f8f9fa;
            padding: 10px;
            margin: 15px 0;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
<h1>行列解法・ICCG法関連文献</h1>
<p>このフォルダには、有限要素法(FEM)などの電磁界解析で用いられる疎行列解法、主にICCG法やCOCG法に関する文献が格納されています。
特に、<strong>日本国内の電磁界解析コミュニティで独自に発展・定着した実装ノウハウ</strong>（Shifted ICCGや $LDL^{T}$ 分解の採用など）や、辺要素FEM特有の収束性に関する議論に焦点を当てています。</p>
<h2>理論的背景 (Theoretical Background)</h2>
<p>電磁界解析（特にFEM）において、離散化により得られる連立一次方程式 $A x=b$ は、大規模かつ疎（Sparse）な構造を持ちます。
この行列 $A$ の性質により、適用すべきクリロフ部分空間法が異なります。</p>
<h3>1. CG法とICCG法</h3>
<p><strong>適用対象</strong>: 実対称正定値行列 (Real Symmetric Positive Definite)</p>
<p>関数 $\phi(x)$ の最小化問題と等価です。</p>
<p>$$
\phi(x) = \frac{1}{2} x^T A x - x^T b
$$</p>
<p>探索方向 $p_k$ が $A$-直交 (共役) であるように選ばれます。</p>
<p>$$
p_i^T A p_j = 0 \quad (i \neq j)
$$</p>
<p>収束性を改善するために、不完全コレスキー分解 (Incomplete Cholesky Decomposition) を前処理行列 $M$ として用いるのが <strong>ICCG法</strong> です。</p>
<p>$$
M = LDL^{T} \approx A
$$</p>
<h3>2. COCG法 (Conjugate Orthogonal CG)</h3>
<p><strong>適用対象</strong>: 複素対称行列 (Complex Symmetric)</p>
<p>$$
A = A^T \quad (\text{ただし通常 } A \neq A^H)
$$
渦電流解析などの周波数領域FEMでは、行列は複素対称になります。これに対して、BiCG法よりも効率的なCOCG法 (van der Vorst, 1990) が用いられます。</p>
<h4>直交性の定義の違い</h4>
<p>通常の複素内積（エルミート内積）ではなく、双線形形式 (bilinear form) を用います。</p>
<p>$$
(x, y)_* = x^T y \quad (\text{共役をとらない})
$$
これにより、CG法と同様の3項漸化式で更新が可能となり、メモリ効率と計算速度が向上します。</p>
<hr />
<h2>電磁界解析における行列解法の歴史的変遷 (Historical Evolution)</h2>
<p>日本の計算電磁気学（Computational Electromagnetics, CEM）分野において、現在の標準的な解法（Shifted ICCG）が確立されるまでには、1980年代から90年代にかけてのハードウェアの進化と、定式化のパラダイムシフトに伴う深い議論の歴史がありました。</p>
<h3>1. バンド行列とベクトル計算機の時代 (~1980年代中盤)</h3>
<p>初期の3次元FEM解析への挑戦は、メモリリソースと計算速度との戦いでした。
*   当初は「バンド行列ソルバ」や「スカイライン法」などの直接法が用いられていましたが、未知数が数1,000を超えると当時のメインフレームでも計算不能に陥りました。
*   <strong>Meijerink &amp; van der Vorst <a href="#ref6" class="ref-link">[6]</a></strong> (1977) による不完全コレスキー分解を用いた前処理付きCG法（ICCG法）の提案は、この状況を一変させました。日本国内では、特に日立・富士通・NECなどの国産スーパーコンピュータ（ベクトル計算機）上でのICCG法の高速化（超平面法によるベクトル化など）が、企業・大学で熱心に研究されました。
*   <strong>岡山大学・中田高義研究室の貢献</strong>: 中田高義教授率いる岡山大学の研究グループ（藤原耕二氏を含む）は、ICCG法の収束特性改善に関して日本をリードする研究を行いました <strong><a href="#ref3" class="ref-link">[3]</a></strong>。特に：
    *   リナンバリング（reverse Cuthill-McKee法など）による行列帯幅縮小と収束改善
    *   <strong>シフト係数（加速係数）</strong> の導入による収束安定化
    *   磁性材料の標準磁気特性測定法の確立
    など、実用化に不可欠な基盤技術を体系的に研究し、「良い前処理を行えば反復法は速い」という認識の定着に大きく貢献しました。中田研出身の研究者は現在も国内外で電磁界解析の第一線で活躍しています。</p>
<h3>2. 辺要素の登場と「特異性の壁」 (1980年代後半〜)</h3>
<p>T. Weiland (FIT) や A. Bossavit (Edge Elements) らにより、スプリアス解を含まないベクトル解析として「辺要素」が理論化されました。しかし、これを実装しようとした研究者たちは、大きな壁に直面しました。
*   <strong>特異行列 (Singular Matrix)</strong>: $\text{rot grad} \phi = 0$ の関係により、係数行列 $A$ が不定（Singular）になり、通常のコレスキー分解やICCG法がそのままでは適用できなかったのです（ピボットがゼロになる）。
*   <strong>世界的な迷走</strong>:
    *   欧米の研究者の多くは、「数学的に正しい行列にする」ことを重視し、Tree-Cotree分解などのグラフ理論を用いてゲージ不定性を除去（Gauge Fixing）する方法を模索しました。しかし、これは前処理の実装を極めて複雑にし、スパース性を損なうものでした。
    *   あるいは、ペナルティ項を加えて無理やり正定値化する方法も試みられましたが、ペナルティ係数の調整という新たな問題を招きました。</p>
<h3>3. 日本独自のブレイクスルー：Shifted ICCG (1990年代初頭)</h3>
<p>この停滞を打破したのが、日本国内の現場からの実用的なアプローチでした。
*   <strong>亀有昭久氏（元・三菱原子力工業、現SSIL）による辺要素FEMへの適用 <a href="#ref2" class="ref-link">[2]</a></strong>:
    *   Kershaw <strong><a href="#ref7" class="ref-link">[7]</a></strong> が1978年にプラズマシミュレーションの負ピボット問題を回避するために提案し、Manteuffel <strong><a href="#ref5" class="ref-link">[5]</a></strong> が理論を体系化した対角シフト付き不完全分解（Shifted IC）を、辺要素FEMの特異行列問題に適用し、その有効性を実証しました。
    *   数学的な厳密さよりも「解けること」を優先した実用的アプローチにより、ゲージ固定のような複雑な前処理を必要とせず、 $LDL^{T}$ 分解（ルートフリー / square-root-free）を用いることで計算も高速な <strong>Shifted ICCG</strong> 法が確立されました。
*   <strong>藤原耕二氏（岡山大、現同志社大）らによるシフト係数の最適化 <a href="#ref3" class="ref-link">[3]</a></strong>:
    *   シフト係数（加速係数）の最適値を求める方法が研究され、実対称行列に対しては自動決定法が提案されています <strong><a href="#ref8" class="ref-link">[8]</a></strong>。
*   <strong>Van der Vorst との交流</strong>:
    *   オランダの H. A. van der Vorst 教授は、電磁界解析コミュニティ（COMPUMAG等）とも深い関わりを持ち、1990年に複素対称行列向けの <strong>COCG法 <a href="#ref4" class="ref-link">[4]</a></strong> を提案しました。
    *   日本の研究者は即座にこれを取り入れ、複素数に対しても Shifted IC + COCG を適用することで、渦電流解析などの周波数応答解析においても「特異行列のまま解く」スタイルを確立しました。</p>
<h3>4. 理論的裏付けとデファクトスタンダード化 (2000年代〜)</h3>
<ul>
<li>長らく「経験的に動く」とされてきたこの手法に対し、<strong>五十嵐 (北大) <a href="#ref1" class="ref-link">[1]</a></strong> は数学的なメスを入れました。<ul>
<li>「ゲージ固定を行うと、むしろ行列のスペクトル特性（固有値分布）が悪化し、収束が遅くなること」を理論的に示しました。</li>
<li>逆に、「特異行列のままであっても、適切な初期値（勾配成分ゼロ）とKrylov部分空間法を組み合わせれば、実質的に良条件の問題として解ける」ことを証明しました。</li>
</ul>
</li>
<li>これにより、Shifted ICCGは単なる「便宜的な手法」から「理論的裏付けのある最適解」へと昇華され、日本発の技術として、現在も多くの商用・アカデミックコードのコアエンジンとして稼働しています。</li>
</ul>
<hr />
<h2>実用的実装の検討 (Practical Implementation)</h2>
<p><strong>岡本ら <a href="#ref9" class="ref-link">[9]</a></strong> (2014) は、国内10研究機関でICCG法の実装をベンチマーキングし、高速化のための実用的な実装法を体系化しました。</p>
<h3>ベンチマークモデル</h3>
<ul>
<li><strong>ボックスシールドモデル</strong>: 節点数558,256、要素数539,105、未知数（DoF）1,594,320、係数行列の非零要素数26,618,443</li>
<li>六面体一次辺要素、磁気ベクトルポテンシャル定式化（線形静磁界）</li>
<li>CRS（Compressed Row Storage）形式で疎行列を格納</li>
</ul>
<h3>対角スケーリングの数学的等価性</h3>
<p>対角スケーリング（点ヤコビ前処理）の有無がIC前処理後の収束特性に影響しないことが数学的に証明されました。</p>
<p>スケーリング行列 $S$ を対角成分 $\sqrt{a_{ii}}$ で定義すると：</p>
<p>$$
\bar{A} = S^{-1}AS^{-T}, \quad \bar{x} = S^{T}x, \quad \bar{b} = S^{-1}b
$$</p>
<p>IC分解 $A \approx CC^{T}$, $\bar{A} \approx \bar{C}\bar{C}^{T}$ に対して、 $\bar{C} = S^{-1}C$ の関係より：</p>
<p>$$
(C^{-1}AC^{-T})(C^{T}x) = C^{-1}b
$$</p>
<p>となり、対角スケーリングの有無に関係なく前処理後の方程式は同値となります。</p>
<h3>実装上の最適化ポイント</h3>
<ol>
<li><strong>IC分解の形式</strong>: $LDL^{T}$ 分解（ルートフリー）において、 $L$ の対角成分を1とする形式（IC type 2）を採用すると、前進代入で40%以上の高速化が可能</li>
<li><strong>前進・後退代入</strong>: 式 $(LD)D^{-1}(LD)^{T}u = r$ の形式に変形し、 $LD$ を格納することで対角成分のメモリアクセスを削減</li>
<li><strong>後退代入のループ方向</strong>: 逆方向にループすることで連続メモリアクセスによる高速化</li>
<li><strong>行列ベクトル積</strong>: 下三角部分のループ内で上三角部分の寄与も同時に計算し、メモリアクセス回数を半減</li>
<li><strong>キャッシュミス回避</strong>: 間接参照によるキャッシュミスを最小化する実装が重要</li>
</ol>
<h3>標準シフト係数</h3>
<ul>
<li>実対称行列に対して $\gamma = 1.06$ が広く使用されています</li>
<li>自動決定法も提案されています <strong><a href="#ref8" class="ref-link">[8]</a></strong></li>
</ul>
<hr />
<h2>参考文献 (References)</h2>
<ol class="references">

<li id="ref1"><strong>H. Igarashi, T. Honma</strong>, "On the property of the ICCG method applied to the finite element equation for quasi-static fields," <em>IEEE Transactions on Magnetics</em>, vol. 38, no. 2, pp. 565-568, 2002.</li>
<li id="ref2"><strong>A. Kameari</strong> (SSIL), "Calculation of transient 3D eddy current using edge-elements," <em>IEEE Transactions on Magnetics</em>, vol. 26, no. 2, pp. 466-469, 1990.</li>
<li id="ref3"><strong>K. Fujiwara, T. Nakata</strong>, "Acceleration of convergence characteristic of the ICCG method," <em>IEEE Transactions on Magnetics</em>, vol. 29, no. 2, pp. 1958-1961, 1993.</li>
<li id="ref4"><strong>H. A. van der Vorst</strong> and J. B. M. Melissen, "A Petrov-Galerkin type method for solving Ax=b, where A is symmetric complex," <em>IEEE Transactions on Magnetics</em>, vol. 26, no. 1, pp. 706-708, 1990.</li>
<li id="ref5"><strong>T. A. Manteuffel</strong>, "An incomplete factorization technique for positive definite linear systems," <em>Mathematics of Computation</em>, vol. 34, no. 150, pp. 473-497, 1980. <a href="https://doi.org/10.1090/S0025-5718-1980-0559197-0">DOI: 10.1090/S0025-5718-1980-0559197-0</a></li>
<li id="ref6"><strong>J. A. Meijerink, H. A. van der Vorst</strong>, "An iterative solution method for linear systems of which the coefficient matrix is a symmetric M-matrix," <em>Mathematics of Computation</em>, vol. 31, no. 137, pp. 148-162, 1977. <a href="https://doi.org/10.1090/S0025-5718-1977-0438681-4">DOI: 10.1090/S0025-5718-1977-0438681-4</a></li>
<li id="ref7"><strong>D. S. Kershaw</strong>, "The incomplete Cholesky-conjugate gradient method for the iterative solution of systems of linear equations," <em>Journal of Computational Physics</em>, vol. 26, no. 1, pp. 43-65, 1978. <a href="https://doi.org/10.1016/0021-9991(78)90098-0">DOI: 10.1016/0021-9991(78)90098-0</a></li>
<li id="ref8"><strong>J. Kitao, Y. Takahashi, K. Fujiwara, T. Mifune, T. Iwashita</strong>, "Automatic determination of acceleration factor in shifted ICCG method for 3-D electromagnetic field analyses," <em>IEEE Transactions on Magnetics</em>, vol. 49, no. 5, pp. 1741-1744, 2013.</li>
<li id="ref9"><strong>Y. Okamoto, Y. Takahashi, K. Fujiwara, A. Ahagon, T. Mifune, T. Iwashita</strong>, "辺要素有限要素解析から得られる実対称線形方程式求解におけるICCG法の実用的実装の検討," <em>電気学会論文誌B</em>, vol. 134, no. 9, pp. 767-776, 2014. <a href="https://doi.org/10.1541/ieejpes.134.767">DOI: 10.1541/ieejpes.134.767</a></li>
</ol>
<hr />
<p><em>Generated by geminiさん on 2026-01-29</em></p>
</body>
</html>
